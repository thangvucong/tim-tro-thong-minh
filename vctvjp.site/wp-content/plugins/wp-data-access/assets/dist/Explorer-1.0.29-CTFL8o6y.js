const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Alert-1.0.29-D7hJvMIL.js","./cm-1.0.29-B-jRz_ox.js","./redux-1.0.29-C1Q38y1F.js","./vendor-1.0.29-BmpNFhoq.js","./index-1.0.29-DNyiXtkx.js","./iconBase-1.0.29-DWX4ew0u.js","./Typography-1.0.29-DKDDWYKJ.js","./lib-1.0.29-C3pCU2AT.js","./loglevel-1.0.29-BZ7XahX3.js","./lodash-1.0.29-CLFJOMhY.js","./moment-1.0.29-C5S46NFB.js","./AlertTitle-1.0.29-DGwwjnOl.js","./createSvgIcon-1.0.29-DRHeS-Ok.js","./Close-1.0.29-DMVND8Dd.js"])))=>i.map(i=>d[i]);
import{_ as Y}from"./main-1.0.29.js";import{a as he,j as e,_ as D}from"./cm-1.0.29-B-jRz_ox.js";import{r as o}from"./redux-1.0.29-C1Q38y1F.js";import{l as ts,a as ss,b as ns,c as as,d as rs,e as os,f as is,g as ls,h as cs}from"./ActionsExplorer-1.0.29-Bd4N6XcI.js";import{a as $,u as Te}from"./RestApi-1.0.29-D1Nj1ewF.js";import{l as u,b as q,aO as ds,aP as ps,aQ as us,aR as xs,aS as ms,aT as gs,aU as we,j as se,aV as hs,aW as fs,aX as js,aY as ys,aZ as ke,a_ as Ee,a$ as xt,b0 as mt,b1 as gt,b2 as ht,b3 as bs,b4 as Ts,C as Cs,aC as Ss,b5 as Is,b6 as vs,b7 as ws}from"./lib-1.0.29-C3pCU2AT.js";import{B as d,C as ks,S as Es}from"./Spinner-1.0.29-BS14fgdJ.js";import{c as ft,i as $e,w as jt,p as Pe,o as Ps,T as De}from"./Typography-1.0.29-DKDDWYKJ.js";import{u as ce,M as de,B as rt,T as yt,a as bt,b as Ae,c as H,d as Tt}from"./index.esm-1.0.29-CvwOQwKB.js";import{T as X,u as He,a as Ls,b as _s,c as Ms}from"./ActionsAdmin-1.0.29-Bq8xyNtX.js";import{f as Ct,g as St,h as It,d as As}from"./index-1.0.29-DNyiXtkx.js";import{H as Le,I as Ds,J as Os,d as Rs,K as zs,t as Bs,L as Fs,A as Ge,T as qe,N as Ks,O as Vs,P as vt,Q as wt,M as Ns,R as Ws,S as $s,v as ot,U as Hs,h as Gs,q as qs,r as Qs,s as Us}from"./index-1.0.29-Dlm2kjka.js";import{a as Ys,b as Js}from"./index-1.0.29-2NwfYhFo.js";import{u as kt,h as Ke,a as Ve,T as Xs,b as Zs,t as U,c as en,d as tn,e as sn,f as nn,g as an,i as rn,j as it,k as on,S as ln}from"./TreeItem2Provider-1.0.29-rBK9p3Tt.js";import{C as J}from"./Checkbox-1.0.29-DTq3kp48.js";import{C as cn}from"./Collapse-1.0.29-BdBN3O_f.js";import{a as lt,e as ct,r as ae,I as le,P as Ne}from"./iconBase-1.0.29-DWX4ew0u.js";import{E as _e}from"./ExplorerActionEnum-1.0.29-eclZgKpy.js";import{A as te}from"./AdminTheme-1.0.29-j2gnN0Eb.js";import{u as dn}from"./index-1.0.29-D3hJYFO0.js";import{T as fe}from"./Tooltip-1.0.29-D8cmS8RQ.js";import{L as re}from"./Link-1.0.29-CGZTGwg7.js";import{u as Oe}from"./useExplorer-1.0.29-CtucJlzW.js";import{C as pn,a as un,B as be}from"./CardContent-1.0.29-D9omFsvB.js";import{C as xn}from"./CardHeader-1.0.29-DE_NhWGG.js";import{F as oe}from"./FormHelperText-1.0.29-DrHduTUH.js";import{F as Me}from"./FormLabel-1.0.29-V40o0R6-.js";import{C as mn}from"./CardActions-1.0.29-m2umL7cE.js";import{T as Et,S as Pt,I as gn}from"./TextField-1.0.29-DGwcptkL.js";import{I as dt}from"./InputAdornment-1.0.29-CO4NNpRp.js";import{D as hn,a as fn,b as jn,C as Lt,T as yn}from"./ConfirmDialog-1.0.29-CS4WrjWL.js";import{D as bn,a as Tn,b as Cn}from"./DialogContent-1.0.29-DSOFFK1-.js";import{M as je}from"./MenuItem-1.0.29-hQUyAg_Q.js";import{e as pt}from"./notistack-1.0.29-DTteiN_s.js";/* empty css                    */import"./vendor-1.0.29-BmpNFhoq.js";import"./loglevel-1.0.29-BZ7XahX3.js";import"./lodash-1.0.29-CLFJOMhY.js";import"./moment-1.0.29-C5S46NFB.js";import"./createSvgIcon-1.0.29-DRHeS-Ok.js";import"./FormControlLabel-1.0.29-BWMy6Yxq.js";import"./useFormControl-1.0.29-DBjraibe.js";import"./Menu-1.0.29-DOOr2lTO.js";import"./ThemeProvider-1.0.29-6fkyOh-r.js";import"./Autocomplete-1.0.29-BeVKfuIu.js";import"./Close-1.0.29-DMVND8Dd.js";import"./Popper-1.0.29-DA77uIz-.js";import"./useControlled-1.0.29-gPCMf8hr.js";import"./TimePicker-1.0.29-lLnNnKJ8.js";import"./useMobilePicker-1.0.29-Df2Tk0E7.js";import"./index-1.0.29-CZwhy2eo.js";import"./visuallyHidden-1.0.29-Dan1xhjv.js";import"./ListItem-1.0.29-D5iRmc9g.js";import"./timeViewRenderers-1.0.29-8ZO1XmkN.js";import"./DateTimePicker-1.0.29-BuM9THmE.js";import"./Tabs-1.0.29-B0UPz-Vu.js";import"./dateViewRenderers-1.0.29-DIZT5Wx_.js";import"./Divider-1.0.29-DUrOUuwN.js";import"./DatePicker-1.0.29-Beqi-UmW.js";import"./Stack-1.0.29-Be5OvNOr.js";import"./Slider-1.0.29-Bfsw0S30.js";import"./ListItemIcon-1.0.29-Ch2iR42N.js";import"./Radio-1.0.29-DtS8PS_A.js";import"./SwitchBase-1.0.29-aa8fP0Df.js";import"./AlertTitle-1.0.29-DGwwjnOl.js";import"./Switch-1.0.29-CFPuiCpy.js";function _t(t){const{instance:s,items:{onItemClick:n},selection:{multiSelect:a,checkboxSelection:i,disableSelection:l},expansion:{expansionTrigger:j}}=kt(),b=s.isItemExpandable(t),T=s.isItemExpanded(t),p=s.isItemFocused(t),f=s.isItemSelected(t),c=s.isItemDisabled(t),m=s!=null&&s.isItemBeingEdited?s==null?void 0:s.isItemBeingEdited(t):!1,R=s.isItemEditable?s.isItemEditable(t):!1,z=g=>{if(!c){p||s.focusItem(g,t);const S=a&&(g.shiftKey||g.ctrlKey||g.metaKey);b&&!(S&&s.isItemExpanded(t))&&s.toggleItemExpansion(g,t)}},I=g=>{c||(p||s.focusItem(g,t),a&&(g.shiftKey||g.ctrlKey||g.metaKey)?g.shiftKey?s.expandSelectionRange(g,t):s.selectItem({event:g,itemId:t,keepExistingSelection:!0}):s.selectItem({event:g,itemId:t,shouldBeSelected:!0}))},C=g=>{if(l||c)return;const S=g.nativeEvent.shiftKey;a&&S?s.expandSelectionRange(g,t):s.selectItem({event:g,itemId:t,keepExistingSelection:a,shouldBeSelected:g.target.checked})},B=g=>{(g.shiftKey||g.ctrlKey||g.metaKey||c)&&g.preventDefault()},M=()=>{Ke(s,Ve)&&s.isItemEditable(t)&&(s.isItemBeingEdited(t)?s.setEditedItemId(null):s.setEditedItemId(t))};return{disabled:c,expanded:T,selected:f,focused:p,editable:R,editing:m,disableSelection:l,checkboxSelection:i,handleExpansion:z,handleSelection:I,handleCheckboxSelection:C,handleContentClick:n,preventSelection:B,expansionTrigger:j,toggleItemEditing:M,handleSaveItemLabel:(g,S)=>{Ke(s,Ve)&&s.isItemBeingEditedRef(t)&&(s.updateItemLabel(t,S),M(),s.focusItem(g,t))},handleCancelItemLabelEditing:g=>{Ke(s,Ve)&&s.isItemBeingEditedRef(t)&&(M(),s.focusItem(g,t))}}}const Sn=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown","dragAndDropOverlayProps","labelInputProps"],Mt=o.forwardRef(function(s,n){const{classes:a,className:i,displayIcon:l,expansionIcon:j,icon:b,label:T,itemId:p,onClick:f,onMouseDown:c,dragAndDropOverlayProps:m,labelInputProps:R}=s,z=he(s,Sn),{disabled:I,expanded:C,selected:B,focused:M,editing:E,editable:A,disableSelection:g,checkboxSelection:S,handleExpansion:F,handleSelection:y,handleCheckboxSelection:L,handleContentClick:w,preventSelection:_,expansionTrigger:r,toggleItemEditing:x}=_t(p),h=b||j||l,P=o.useRef(null),k=V=>{_(V),c&&c(V)},K=V=>{var ee;w==null||w(V,p),!((ee=P.current)!=null&&ee.contains(V.target))&&(r==="content"&&F(V),S||y(V),f&&f(V))},Q=V=>{V.defaultMuiPrevented||x()};return e.jsxs("div",D({},z,{className:ft(a.root,i,C&&a.expanded,B&&a.selected,M&&a.focused,I&&a.disabled,E&&a.editing,A&&a.editable),onClick:K,onMouseDown:k,ref:n,children:[e.jsx("div",{className:a.iconContainer,children:h}),S&&e.jsx(J,{className:a.checkbox,checked:B,onChange:L,disabled:I||g,ref:P,tabIndex:-1}),E?e.jsx(Xs,D({},R,{className:a.labelInput})):e.jsx("div",D({className:a.label},A&&{onDoubleClick:Q},{children:T})),m&&e.jsx(Zs,D({},m))]}))}),In=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],vn=["ownerState"],wn=["ownerState"],kn=["ownerState"],En=an(),Pn=t=>{const{classes:s}=t;return Ps({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],checkbox:["checkbox"],label:["label"],labelInput:["labelInput"],editing:["editing"],editable:["editable"],groupTransition:["groupTransition"]},rn,s)},Ln=$e("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(t,s)=>s.root})({listStyle:"none",margin:0,padding:0,outline:0}),_n=$e(Mt,{name:"MuiTreeItem",slot:"Content",overridesResolver:(t,s)=>[s.content,s.iconContainer&&{[`& .${U.iconContainer}`]:s.iconContainer},s.label&&{[`& .${U.label}`]:s.label}],shouldForwardProp:t=>jt(t)&&t!=="indentationAtItemLevel"})(({theme:t})=>({padding:t.spacing(.5,1),borderRadius:t.shape.borderRadius,width:"100%",boxSizing:"border-box",position:"relative",display:"flex",alignItems:"center",gap:t.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${U.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${U.focused}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${U.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Pe(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Pe(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Pe(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${U.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Pe(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`& .${U.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${U.label}`]:D({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},t.typography.body1),[`& .${U.checkbox}`]:{padding:0},variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:`calc(${t.spacing(1)} + var(--TreeView-itemChildrenIndentation) * var(--TreeView-itemDepth))`}}]})),Mn=$e(cn,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(t,s)=>s.groupTransition,shouldForwardProp:t=>jt(t)&&t!=="indentationAtItemLevel"})({margin:0,padding:0,paddingLeft:"var(--TreeView-itemChildrenIndentation)",variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:0}}]}),G=o.forwardRef(function(s,n){var Ze,et,tt,st;const{icons:a,runItemPlugins:i,items:{disabledItemsFocusable:l,indentationAtItemLevel:j},selection:{disableSelection:b},expansion:{expansionTrigger:T},treeId:p,instance:f}=kt(),c=o.useContext(en),m=En({props:s,name:"MuiTreeItem"}),{children:R,className:z,slots:I,slotProps:C,ContentComponent:B=Mt,ContentProps:M,itemId:E,id:A,label:g,onClick:S,onMouseDown:F,onBlur:y,onKeyDown:L}=m,w=he(m,In),{expanded:_,focused:r,selected:x,disabled:h,editing:P,handleExpansion:k,handleCancelItemLabelEditing:K,handleSaveItemLabel:Q}=_t(E),{contentRef:V,rootRef:ee,propsEnhancers:N}=i(m),Ce=o.useRef(null),Qe=o.useRef(null),Ot=lt(n,ee,Ce),Rt=lt(M==null?void 0:M.ref,V,Qe),xe={expandIcon:(I==null?void 0:I.expandIcon)??a.slots.expandIcon??tn,collapseIcon:(I==null?void 0:I.collapseIcon)??a.slots.collapseIcon??sn,endIcon:(I==null?void 0:I.endIcon)??a.slots.endIcon,icon:I==null?void 0:I.icon,groupTransition:I==null?void 0:I.groupTransition},Ue=v=>Array.isArray(v)?v.length>0&&v.some(Ue):!!v,Se=Ue(R),Re=D({},m,{expanded:_,focused:r,selected:x,disabled:h,indentationAtItemLevel:j}),W=Pn(Re),Ye=xe.groupTransition??void 0,zt=Le({elementType:Ye,ownerState:{},externalSlotProps:C==null?void 0:C.groupTransition,additionalProps:D({unmountOnExit:!0,in:_,component:"ul",role:"group"},j?{indentationAtItemLevel:!0}:{}),className:W.groupTransition}),Bt=v=>{T==="iconContainer"&&k(v)},ze=_?xe.collapseIcon:xe.expandIcon,Ft=Le({elementType:ze,ownerState:{},externalSlotProps:v=>_?D({},ae(a.slotProps.collapseIcon,v),ae(C==null?void 0:C.collapseIcon,v)):D({},ae(a.slotProps.expandIcon,v),ae(C==null?void 0:C.expandIcon,v)),additionalProps:{onClick:Bt}}),Kt=he(Ft,vn),Vt=Se&&ze?e.jsx(ze,D({},Kt)):null,Be=Se?void 0:xe.endIcon,Nt=Le({elementType:Be,ownerState:{},externalSlotProps:v=>Se?{}:D({},ae(a.slotProps.endIcon,v),ae(C==null?void 0:C.endIcon,v))}),Wt=he(Nt,wn),$t=Be?e.jsx(Be,D({},Wt)):null,Fe=xe.icon,Ht=Le({elementType:Fe,ownerState:{},externalSlotProps:C==null?void 0:C.icon}),Gt=he(Ht,kn),qt=Fe?e.jsx(Fe,D({},Gt)):null;let Ie;x?Ie=!0:b||h?Ie=void 0:Ie=!1;function Qt(v){!r&&(!h||l)&&v.currentTarget===v.target&&f.focusItem(v,E)}function Ut(v){var ne,me,nt,at;y==null||y(v),!(P||v.relatedTarget&&it(v.relatedTarget,Ce.current)&&(v.target&&((me=(ne=v.target)==null?void 0:ne.dataset)==null?void 0:me.element)==="labelInput"&&it(v.target,Ce.current)||((at=(nt=v.relatedTarget)==null?void 0:nt.dataset)==null?void 0:at.element)==="labelInput"))&&f.removeFocusedItem()}const Yt=v=>{var ne,me;L==null||L(v),((me=(ne=v.target)==null?void 0:ne.dataset)==null?void 0:me.element)!=="labelInput"&&f.handleItemKeyDown(v,E)},Jt=on({itemId:E,treeId:p,id:A}),Xt=f.canItemBeTabbed(E)?0:-1,ve={rootRefObject:Ce,contentRefObject:Qe,interactions:{handleSaveItemLabel:Q,handleCancelItemLabelEditing:K}},Zt=((Ze=N.root)==null?void 0:Ze.call(N,D({},ve,{externalEventHandlers:ct(w)})))??{},es=((et=N.content)==null?void 0:et.call(N,D({},ve,{externalEventHandlers:ct(M)})))??{},Je=((tt=N.dragAndDropOverlay)==null?void 0:tt.call(N,D({},ve,{externalEventHandlers:{}})))??{},Xe=((st=N.labelInput)==null?void 0:st.call(N,D({},ve,{externalEventHandlers:{}})))??{};return e.jsx(nn,{itemId:E,children:e.jsxs(Ln,D({className:ft(W.root,z),role:"treeitem","aria-expanded":Se?_:void 0,"aria-selected":Ie,"aria-disabled":h||void 0,id:Jt,tabIndex:Xt},w,{ownerState:Re,onFocus:Qt,onBlur:Ut,onKeyDown:Yt,ref:Ot,style:j?D({},w.style,{"--TreeView-itemDepth":typeof c=="function"?c(E):c}):w.style},Zt,{children:[e.jsx(_n,D({as:B,classes:{root:W.content,expanded:W.expanded,selected:W.selected,focused:W.focused,disabled:W.disabled,editable:W.editable,editing:W.editing,iconContainer:W.iconContainer,label:W.label,labelInput:W.labelInput,checkbox:W.checkbox},label:g,itemId:E,onClick:S,onMouseDown:F,icon:qt,expansionIcon:Vt,displayIcon:$t,ownerState:Re},M,es,Je.action==null?{}:{dragAndDropOverlayProps:Je},Xe.value==null?{}:{labelInputProps:Xe},{ref:Rt})),R&&e.jsx(Mn,D({as:Ye},zt,{children:R}))]}))})}),Z=()=>e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(ks,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(De,{children:"Loading..."})]}),pe={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},ue=({msg:t})=>e.jsx(d,{sx:{padding:"1rem 0"},children:e.jsx(De,{children:t})}),An=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Dn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.columnsLoaded[s]??!1,l=o.useMemo(()=>(n==null?void 0:n.columns[s])??[],[n.columns]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ts(t,s,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(ds({dbs:t,tbl:s,cls:m}))},c=>{u.error("error",c),b(c??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),f=ce({...pe,columns:p,data:l,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(An,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Table has no columns"}):(u.debug(l),e.jsx(de,{table:f})):e.jsx(Z,{})},On=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Rn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.indexesLoaded[s]??!1,l=o.useMemo(()=>(n==null?void 0:n.indexes[s])??[],[n.indexes]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ss(t,s,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(ps({dbs:t,tbl:s,idx:m}))},c=>{u.error("error",c),b(c??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),f=ce({...pe,columns:p,data:l,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(On,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Table has no indexes"}):e.jsx(de,{table:f}):e.jsx(Z,{})},zn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Bn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.triggersLoaded[s]??!1,l=o.useMemo(()=>(n==null?void 0:n.triggers[s])??[],[n.triggers]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ns(t,s,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(us({dbs:t,tbl:s,trg:m}))},c=>{u.error("error",c),b(c??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:c})=>e.jsx("pre",{style:{padding:0,margin:0},children:c.getValue()})}],[]),f=ce({...pe,columns:p,data:l,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(zn,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Table has no triggers"}):e.jsx(de,{table:f}):e.jsx(Z,{})},Fn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Kn=({dbs:t,tbl:s,database:n})=>{u.debug(t,s);const a=$(),i=n.foreignKeysLoaded[s]??!1,l=o.useMemo(()=>(n==null?void 0:n.foreignKeys[s])??[],[n.foreignKeys]),[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{as(t,s,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(xs({dbs:t,tbl:s,frk:m}))},c=>{u.error("error",c),b(c)})},p=o.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),f=ce({...pe,columns:p,data:l,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Fn,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Table contains no foreign keys"}):e.jsx(de,{table:f}):e.jsx(Z,{})},At=o.memo(({dbs:t,tbl:s,typ:n,database:a})=>(u.debug(t,s,n),e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-"+s+"-columns",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ds,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Dn,{dbs:t,tbl:s,database:a})}),n===X.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-"+s+"-indexes",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Os,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Rn,{dbs:t,tbl:s,database:a})}),e.jsx(G,{itemId:t+"-"+s+"-foreignkeys",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ys,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Kn,{dbs:t,tbl:s,database:a})}),e.jsx(G,{itemId:t+"-"+s+"-triggers",label:e.jsxs(d,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ct,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Bn,{dbs:t,tbl:s,database:a})})]})]}))),Dt=o.memo(({dbs:t,tbl:s,typ:n,tableContext:a,database:i})=>{var f,c;u.debug(t,s,n);const l=$(),j=i.tablesSelected,b=i.viewsSelected,T=dn("(max-width:900px)"),p=o.useMemo(()=>(a==null?void 0:a.wp_tables)!==void 0&&a.wp_tables.filter(m=>m===s).length>0?" (WordPress Table)":(a==null?void 0:a.wpda_tables)!==void 0&&a.wpda_tables.filter(m=>m===s).length>0?" (Plugin Table)":"",[]);return e.jsxs(d,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:T?"hidden":"visible"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(d,{sx:{display:"grid",alignItems:"center"},children:e.jsx(J,{size:"small",checked:b.includes(s)||j.includes(s),onClick:m=>{n===X.VIEW?l(ms({dbs:t,vws:s,isSelected:!b.includes(s)})):l(gs({dbs:t,tbl:s,isSelected:!j.includes(s)})),m.stopPropagation()}})}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(d,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[s," ",p]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(fe,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(re,{underline:"none",onClick:m=>{l(we({dbs:t,tbl:s,typ:n,explorerAction:_e.MANAGE})),m.preventDefault(),m.stopPropagation()},children:"Manage"})}),e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(fe,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(re,{underline:"none",onClick:m=>{l(we({dbs:t,tbl:s,typ:n,explorerAction:_e.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(fe,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(f=te)==null?void 0:f.palette.primary.main},onClick:m=>{l(we({dbs:t,tbl:s,typ:n,explorerAction:_e.MANAGE})),m.preventDefault(),m.stopPropagation()},children:e.jsx(Rs,{})})}),e.jsx(fe,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(le,{sx:{color:(c=te)==null?void 0:c.palette.primary.main},onClick:m=>{l(we({dbs:t,tbl:s,typ:n,explorerAction:_e.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:e.jsx(zs,{})})})]})]})}),Vn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Nn=o.memo(({dbs:t,search:s,database:n})=>{const a=$();u.debug(t,s);const i=n.tablesLoaded,l=n.tables,j=n.tablesContext,[b,T]=o.useState("");return o.useEffect(()=>{i||rs(t,function(p){const f=p==null?void 0:p.data;u.debug("response data",f),a(hs({dbs:t,tbl:f,context:p.context??void 0}))},p=>{u.error("error",p),T(p??q.contactSupport)})},[i]),b!==""?e.jsx(o.Suspense,{children:e.jsx(Vn,{severity:"error",message:b,close:!1})}):i?i&&l.length===0?e.jsx(d,{sx:{padding:"1rem"},children:e.jsx(De,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...l.map(p=>{const f=!se(p,s);return e.jsx(G,{itemId:t+"-"+p,label:e.jsx(Dt,{dbs:t,tbl:p,typ:X.TABLE,tableContext:j,database:n}),sx:{visibility:f?"hidden":"inherit",position:f?"fixed !important":"inherit"},children:e.jsx(At,{dbs:t,tbl:p,typ:X.TABLE,database:n})})})]}):e.jsx(Z,{})}),Wn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),$n=({dbs:t,search:s,database:n})=>{const a=$();u.debug(t,s);const i=n.viewsLoaded,l=n.views,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{os(t,p=>{const f=p==null?void 0:p.data;u.debug("response data",f),a(fs({dbs:t,vws:f}))},p=>{u.error("error",p),b(p??q.contactSupport)})};return j!==""?e.jsx(o.Suspense,{children:e.jsx(Wn,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(d,{sx:{padding:"1rem"},children:e.jsx(De,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...l.map(p=>{const f=!se(p,s);return e.jsx(G,{itemId:t+"-"+p,label:e.jsx(Dt,{dbs:t,tbl:p,typ:X.VIEW,database:n}),sx:{visibility:f?"hidden":"unset",position:f?"fixed !important":"inherit"},children:e.jsx(At,{dbs:t,tbl:p,typ:X.VIEW,database:n})})})]}):e.jsx(Z,{})},Hn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Gn=({dbs:t,search:s,database:n})=>{u.debug(t,s);const a=$(),i=n.proceduresLoaded,l=n.procedures,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{is(t,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(js({dbs:t,prc:m}))},c=>{u.error("error",c),b(c??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:c})=>e.jsx("pre",{style:{padding:0,margin:0},children:c.getValue()})}],[]),f=ce({...pe,columns:p,data:l.filter(c=>se(c.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(Hn,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Database contains no stored procedures"}):e.jsx(de,{table:f}):e.jsx(Z,{})},qn=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Qn=({dbs:t,search:s,database:n})=>{u.debug(t,s);const a=$(),i=n.functionsLoaded,l=n.functions,[j,b]=o.useState("");o.useEffect(()=>{i||T()},[i]);const T=()=>{ls(t,c=>{const m=c==null?void 0:c.data;u.debug("response data",m),a(ys({dbs:t,fnc:m}))},c=>{u.error("error",c),b(c??q.contactSupport)})},p=o.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:c})=>e.jsx("pre",{style:{padding:0,margin:0},children:c.getValue()})}],[]),f=ce({...pe,columns:p,data:l.filter(c=>se(c.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return u.debug(f),j!==""?e.jsx(o.Suspense,{children:e.jsx(qn,{severity:"error",message:j,close:!1})}):i?i&&l.length===0?e.jsx(ue,{msg:"Database contains no functions"}):e.jsx(de,{table:f}):e.jsx(Z,{})};var O=(t=>(t.WP="wp",t.LOCAL="local",t.REMOTE="remote",t.SYSTEM="system",t))(O||{});const Un=({setShowFilter:t})=>{const s=$(),a=Oe().dbsTypes;return o.useEffect(()=>{try{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(a))}catch(i){u.debug(i)}},[a]),e.jsxs(pn,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(xn,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(un,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(d,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(oe,{children:e.jsxs(Me,{children:[e.jsx(J,{size:"small",checked:a.includes(O.WP),onChange:(i,l)=>{s(l?ke({dbsType:O.WP}):Ee({dbsType:O.WP}))}}),"WordPress database"]})}),e.jsx(oe,{children:e.jsxs(Me,{children:[e.jsx(J,{size:"small",checked:a.includes(O.LOCAL),onChange:(i,l)=>{s(l?ke({dbsType:O.LOCAL}):Ee({dbsType:O.LOCAL}))}}),"Local databases"]})}),e.jsx(oe,{children:e.jsxs(Me,{children:[e.jsx(J,{size:"small",checked:a.includes(O.REMOTE),onChange:(i,l)=>{s(l?ke({dbsType:O.REMOTE}):Ee({dbsType:O.REMOTE}))}}),"Remote databases"]})}),e.jsx(oe,{children:e.jsxs(Me,{children:[e.jsx(J,{size:"small",checked:a.includes(O.SYSTEM),onChange:(i,l)=>{s(l?ke({dbsType:O.SYSTEM}):Ee({dbsType:O.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(mn,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(d,{}),e.jsx(be,{variant:"contained",onClick:()=>t(!1),children:"OK"})]})]})},ie=({search:t,setSearch:s,addFilter:n})=>{u.debug(t,n);const[a,i]=o.useState(!1);return e.jsxs(d,{sx:{position:"relative"},children:[e.jsx(Et,{value:t,type:"search",onChange:l=>{s(l.target.value)},onClick:l=>{l.stopPropagation()},onKeyDown:l=>{l.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(dt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Bs,{})}),endAdornment:e.jsx(e.Fragment,{children:n&&e.jsx(dt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(le,{onClick:()=>{i(!a)},children:e.jsx(Fs,{})})})})}}}),a&&e.jsx(Un,{setShowFilter:i})]})},Yn=(t,s)=>{const n=Te(a=>a.explorer.database===void 0||a.explorer.database===null||a.explorer.database[t].tables.length===0?!1:a.explorer.database[t].tables.filter(l=>se(l,s)).length===a.explorer.database[t].tablesSelected.length);return u.debug("allTablesSelected",n),n},Jn=(t,s)=>{const n=Te(a=>a.explorer.database===void 0||a.explorer.database===null||a.explorer.database[t].views.length===0?!1:a.explorer.database[t].views.filter(l=>se(l,s)).length===a.explorer.database[t].viewsSelected.length);return u.debug("allViewsSelected",n),n},ye=t=>{let s="";try{s=localStorage.getItem(t)??""}catch(l){u.debug(l)}const[n,a]=o.useState(s),i=l=>{a(l);try{localStorage.setItem(t,l)}catch(j){u.debug(j)}};return u.debug(n),{search:n,setSearch:i}},Xn=o.memo(({dbs:t})=>{u.debug(t);const s=$(),[n,a]=o.useState(!1),{search:i,setSearch:l}=ye(`ppExplorerSearchTables-${t}`);u.debug(n,i);const[j,b]=o.useState(!1),{search:T,setSearch:p}=ye(`ppExplorerSearchViews-${t}`);u.debug(j,T);const[f,c]=o.useState(!1),{search:m,setSearch:R}=ye(`ppExplorerSearchProcedures-${t}`);u.debug(f,m);const[z,I]=o.useState(!1),{search:C,setSearch:B}=ye(`ppExplorerSearchFunctions-${t}`);u.debug(z,C);const M=Yn(t,i),E=Jn(t,T),[A,g]=o.useState("");u.debug(A);const S=He(),F=S[t];return e.jsxs(e.Fragment,{children:[e.jsx(G,{itemId:t+"-tables",className:"pp-data-exporer-table-tree-item "+A,onClickCapture:y=>{var L,w;!(y.target instanceof HTMLInputElement)&&!(y.target instanceof HTMLAnchorElement)&&!((L=y.target.closest("span"))!=null&&L.classList.contains("pp-select-all-tables"))&&((w=y.target.closest("li"))!=null&&w.classList.contains("pp-data-exporer-table-tree-item"))&&(g(A===""?"hide-details":""),n?y.stopPropagation():(a(!0),g("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:n&&A===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[n&&A===""?e.jsx(J,{size:"small",className:"pp-select-all-tables",checked:M,onClick:y=>{s(xt({dbs:t,isSelected:!M,search:i})),y.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(St,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].tablesLoaded===!0?"("+S[t].tables.length+"/"+S[t].tablesSelected.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(mt({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:n&&A===""&&e.jsx(ie,{search:i,setSearch:l})})]}),children:e.jsx(Nn,{dbs:t,search:i,database:F})}),e.jsx(G,{itemId:t+"-views",onClick:()=>{b(!j)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:j?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[j?e.jsx(J,{size:"small",checked:E,onClick:y=>{s(gt({dbs:t,isSelected:!E,search:T})),y.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(It,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].viewsLoaded===!0?"("+S[t].views.length+"/"+S[t].viewsSelected.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(ht({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:j&&e.jsx(ie,{search:T,setSearch:p})})]}),sx:{padding:0,minWidth:0},children:e.jsx($n,{dbs:t,search:T,database:F})}),e.jsx(G,{itemId:t+"-procedures",onClick:()=>{c(!f)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Ct,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].proceduresLoaded===!0?"("+S[t].procedures.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(bs({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:f&&e.jsx(ie,{search:m,setSearch:R})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Gn,{dbs:t,search:m,database:F})}),e.jsx(G,{itemId:t+"-functions",onClick:()=>{I(!z)},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Js,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:S[t].functionsLoaded===!0?"("+S[t].functions.length+")":""})]})]}),e.jsxs(d,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(d,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(re,{underline:"none",onClick:y=>{s(Ts({dbs:t})),y.preventDefault(),y.stopPropagation()},children:"Refresh"})]})]}),e.jsx(d,{children:z&&e.jsx(ie,{search:C,setSearch:B})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Qn,{dbs:t,search:C,database:F})})]})}),Zn=()=>{const t=Te(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(n=>s.explorer.database[n].tablesSelected).flat().length);return u.debug("countSelectedTables",t),t},ea=()=>{const t=Te(s=>s.explorer.database===void 0||s.explorer.database===null?!1:Object.keys(s.explorer.database).filter(n=>s.explorer.database[n].tablesSelected.length>0||s.explorer.database[n].viewsSelected.length>0).length>0);return u.debug("hasBulkActions",t),t},ta=()=>{const t=Te(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(n=>s.explorer.database[n].viewsSelected).flat().length);return u.debug("countSelectedViews",t),t};function sa(t){const s=o.useRef(null);return e.jsx(jn,{nodeRef:s,handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]',children:e.jsx(Ne,{ref:s,...t})})}const We=t=>{const{title:s,message:n,open:a,setOpen:i,onConfirm:l}=t;return e.jsxs(bn,{open:a,onClose:()=>i(!1),PaperComponent:sa,"aria-labelledby":"confirm-dialog",children:[e.jsx(hn,{style:{marginTop:"10px",cursor:"move"},id:"draggable-dialog-title",children:s}),e.jsx(Tn,{children:e.jsx(fn,{component:"div",children:n})}),e.jsx(Cn,{sx:{marginRight:"15px",marginBottom:"15px"},children:e.jsx(be,{variant:"contained",onClick:()=>{i(!1),l!==void 0&&l()},children:"OK"})})]})},ge={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},na=()=>{const t=$(),s=ea(),n=Oe(),a=He(),i=Zn(),l=ta(),j=n.context,[b,T]=o.useState({}),[p,f]=o.useState("*"),[c,m]=o.useState(null),[R,z]=o.useState(!1),[I,C]=o.useState(!1),[B,M]=o.useState(!1);o.useEffect(()=>{i===0&&(p==="export"||p==="truncate")&&f("*")},[i]);const E={vertical:"top",horizontal:"right"},A=()=>{const r={};return a==null?{}:(Object.keys(a).map(x=>{a[x].tablesSelected.map(h=>{r[x]===void 0&&(r[x]={}),r[x][h]={status:null,typ:X.TABLE}}),p==="drop"&&a[x].viewsSelected.map(h=>{r[x]===void 0&&(r[x]={}),r[x][h]={status:null,typ:X.VIEW}})}),r)},g=(r,x,h)=>{const P={...b};x==="*"?Object.keys(P[r]).map(k=>P[r][k].status=h):P[r][x].status=h,T(P)},S=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{window.document.getElementById(`pp-export-tables-${r}`).submit(),g(r,"*",!0)})},F=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{Object.keys(b[r]).map(x=>{Ls(r,x,h=>{u.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?g(r,x,!0):g(r,x,!1)},h=>{u.error("error",r,x,h),g(r,x,!1)})})})},y=()=>{Object.keys(b).length>0&&Object.keys(b).map(r=>{Object.keys(b[r]).map(x=>{_s(r,x,b[r][x].typ,h=>{u.debug(h),(h==null?void 0:h.code)==="ok"&&(h==null?void 0:h.message)!==void 0?g(r,x,!0):g(r,x,!1)},h=>{u.error("error",h),g(r,x,!1)})})})},L=r=>e.jsxs(yt,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(bt,{children:e.jsxs(Ae,{children:[e.jsx(H,{children:"Database"}),e.jsx(H,{children:"Table | View"}),e.jsx(H,{children:"Status"})]})}),e.jsx(Tt,{children:Object.keys(r).map(x=>Object.keys(r[x]).map((h,P)=>{var k,K;return e.jsxs(Ae,{children:[e.jsx(H,{children:P===0?x:null}),e.jsx(H,{children:h}),e.jsxs(H,{children:[r[x][h]===null&&e.jsx(Vs,{style:{display:"block",margin:"0 auto"}}),r[x][h].status===!0&&e.jsx(vt,{color:(k=te)==null?void 0:k.palette.success.main,style:{display:"block",margin:"0 auto"}}),r[x][h].status===!1&&e.jsx(wt,{color:(K=te)==null?void 0:K.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},P)}))})]}),w=()=>e.jsx(d,{children:L(b)}),_=()=>{const r=A();return T(r),e.jsxs(d,{children:[L(r),(p==="truncate"||p==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(d,{sx:{marginTop:"20px",marginBottom:"20px"},children:p==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(d,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(d,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(d,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Ks,{}),e.jsxs("span",{children:["Does not ",p," WordPress tables"]})]})]})]})};return s?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(qe,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(oe,{variant:"standard",sx:{minWidth:200},children:e.jsxs(Pt,{MenuProps:{id:"pp-select-menu"},value:p,onChange:r=>{f(r.target.value)},children:[e.jsx(je,{value:"*",children:"Bulk actions"}),e.jsx(je,{value:"export",disabled:i===0,children:ge.export}),e.jsx(je,{value:"truncate",disabled:i===0,children:ge.truncate}),e.jsx(je,{value:"drop",children:ge.drop})]})}),e.jsx(be,{variant:"contained",onClick:()=>{p!=="*"?(m(_()),z(!0)):C(!0)},children:"Apply"})]}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(rt,{badgeContent:i,color:"info",anchorOrigin:E,children:e.jsx(St,{color:"action",size:20})}),e.jsx(rt,{badgeContent:l,color:"info",anchorOrigin:E,children:e.jsx(It,{color:"action",size:20})})]})]})}),p==="export"&&Object.keys(b).map(r=>e.jsxs("form",{id:"pp-export-tables-"+r,action:j.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:r}),Object.keys(b[r]).map(x=>e.jsx("input",{type:"hidden",name:"table_names[]",value:x},x)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:j.wp.nonce.split("-")[0]})]},"pp-export-tables-"+r)),e.jsx(We,{title:"Apply bulk action",message:"No bulk action selected",open:I,setOpen:C}),e.jsx(Lt,{title:ge[p],message:c,open:R,setOpen:z,onConfirm:()=>{switch(M(!0),p){case"export":S();break;case"truncate":F();break;case"drop":y()}}}),e.jsx(We,{title:ge[p],message:w(),open:B,setOpen:M,onConfirm:()=>{Object.keys(b).map(r=>{t(mt({dbs:r})),t(xt({dbs:r,isSelected:!1,search:""})),t(ht({dbs:r})),t(gt({dbs:r,isSelected:!1,search:""}))})}})]}):null},aa=({setCanImport:t})=>{var L,w,_;const s=Oe(),n=He(),a=s.context,[i,l]=o.useState(""),[j,b]=o.useState("");o.useEffect(()=>{if(n!=null&&Object.keys(n).length>0){const r=Object.keys(n).filter(x=>n[x].dbsType===O.WP);(r==null?void 0:r.length)>0&&l(r[0])}},[n]);const T=o.useRef(null),[p,f]=o.useState(null),c=(L=a==null?void 0:a.wp)!=null&&L.zip?".sql,.zip":".sql",m=(w=a==null?void 0:a.wp)!=null&&w.zip?"SQL and ZIP":"SQL",R=(_=a==null?void 0:a.wp)==null?void 0:_.upload,[z,I]=o.useState(!1),[C,B]=o.useState(null),[M,E]=o.useState(!1),[A,g]=o.useState(""),[S,F]=o.useState(null),y=r=>e.jsx(e.Fragment,{children:e.jsxs(yt,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(bt,{children:e.jsxs(Ae,{children:[e.jsx(H,{children:"Import file"}),e.jsx(H,{children:"Message"}),e.jsx(H,{children:"Status"})]})}),e.jsx(Tt,{children:r.map(x=>Object.keys(x).map(h=>{var P,k;return e.jsxs(Ae,{children:[e.jsx(H,{sx:{verticalAlign:"text-top"},children:h}),e.jsxs(H,{sx:{verticalAlign:"text-top"},children:[x[h].msg,x[h].errors.map(K=>{var Q;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(Q=te)==null?void 0:Q.palette.error.main},children:K})})})]}),e.jsx(H,{sx:{verticalAlign:"text-top"},children:x[h].status==="error"?e.jsx(wt,{color:(P=te)==null?void 0:P.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(vt,{color:(k=te)==null?void 0:k.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},h)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(d,{className:"pp-import-container",sx:{position:"relative","& > .tooltip":{position:"absolute !important",top:"10px",right:"10px",zIndex:999}},children:[e.jsx(yn,{title:"Close",position:"bottom",children:e.jsx(le,{onClick:()=>{T.current&&(T.current.value=""),b(""),t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Ns,{})})}),e.jsx(Ge,{className:"pp-import-container",color:"inherit",position:"relative",elevation:4,sx:{display:"grid",alignItems:"center",margin:"0 0 5px 0"},children:e.jsxs(qe,{sx:{display:"grid",gap:"10px",alignItems:"center",height:"max-content",paddingTop:"50px",paddingBottom:"30px"},children:[e.jsx(e.Fragment,{children:e.jsxs(d,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"15px"},children:[e.jsx(d,{children:e.jsxs(oe,{sx:{minWidth:"300px"},children:[e.jsx(gn,{variant:"outlined",children:"Select destination database"}),e.jsx(Pt,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:i,onChange:r=>{l(r.target.value)},children:n!=null&&Object.keys(n).map(r=>{const x=n[r].dbsType===O.WP?r+" (WordPress database)":r;return e.jsx(je,{value:r,children:x},r)})})]})}),e.jsx(d,{children:e.jsx("form",{children:e.jsxs(be,{component:"label",variant:"outlined",startIcon:e.jsx(Ws,{}),children:["Select file(s)",e.jsx(Et,{type:"file",slotProps:{input:{inputRef:T},htmlInput:{accept:c,multiple:!0}},onChange:r=>{const x=r.target.files;f(x);const h=Object.keys(x).map(P=>x[P].name).toString();b(h)},sx:{display:"none"}})]})})}),j!==""&&e.jsx(e.Fragment,{children:e.jsx(d,{children:e.jsx(be,{component:"label",variant:"contained",startIcon:e.jsx($s,{}),onClick:()=>{B(e.jsxs(d,{children:[e.jsxs(d,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:j})]}),e.jsxs(d,{children:["Selected database: ",e.jsx("strong",{children:i})]}),e.jsxs(d,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"  You can work on other tasks while your import is performed in the background."]})]})),I(!0)},children:"Import file(s)"})})})]})}),j!==""&&e.jsxs(d,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",j]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",padding:"10px 30px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",m," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",R,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})})]}),e.jsx(Lt,{title:"Import selected file(s)?",message:C,open:z,setOpen:I,onConfirm:()=>{Ms(i,p,r=>{var x;if(r!=null&&r.message&&((x=r==null?void 0:r.context)!=null&&x.imported)&&Array.isArray(r.context.imported)){const h=r.context.imported;E(!0),g(r.message),F(y(h))}else pt(q.contactSupport,{variant:"error"})},r=>{u.error("error",r),pt(q.contactSupport,{variant:"error"})})}}),e.jsx(We,{title:A,message:S,open:M,setOpen:E,onConfirm:()=>{b(""),t(!1)}})]})},ut=o.lazy(()=>Y(()=>import("./Alert-1.0.29-D7hJvMIL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),fr=()=>{var F;const t=$(),s=o.useRef(null),{search:n,setSearch:a}=ye("ppExplorerSearch"),i=Oe(),l=i.database,j=i.error,b=i.selected,T=i.dbsTypes,[p,f]=o.useState("");o.useEffect(()=>{window.ppActionEnableImport=(y=!0)=>{B(y)},c()},[]);const c=()=>{let y=[],L="";try{L=localStorage.getItem("ppExplorerSearchDbsTypes")}catch(w){u.debug(w)}L!=null&&L!==""?y=JSON.parse(L):y=[O.WP,O.LOCAL,O.REMOTE],cs(w=>{const _=w==null?void 0:w.data;u.debug("response data",_);const r=[],x={};_.map(k=>{r.push({dbs:k.dbs,dbsType:k.dbs_type,pdsDbs:k.pds}),x[k.dbs]=!1}),R(x),r.sort((k,K)=>{var Q,V,ee,N;return((Q=k==null?void 0:k.dbs)==null?void 0:Q.toLocaleLowerCase())>((V=K==null?void 0:K.dbs)==null?void 0:V.toLocaleLowerCase())?1:((ee=K==null?void 0:K.dbs)==null?void 0:ee.toLocaleLowerCase())>((N=k==null?void 0:k.dbs)==null?void 0:N.toLocaleLowerCase())?-1:0}),u.debug(r),t(Is({dbs:r,dbsTypes:y}));const h={};_.map(k=>{h[k.dbs]=k.dbs_type}),t(vs({dbs:h}));const P=w.context;u.debug("context",P),t(ws({context:P}))},w=>{u.error("error",w),f(w??q.contactSupport)})},[m,R]=o.useState({}),[z,I]=o.useState(!0),[C,B]=o.useState(!1),M=()=>e.jsx(fe,{title:"Import data or execute scripts",children:e.jsx(le,{sx:{color:"inherit"},onClick:()=>{B(!C)},children:e.jsx(Gs,{})})}),E=()=>e.jsx(le,{onClick:()=>{S(g==="large"?"medium":g==="medium"?"small":"large")},sx:{color:"#fff"},children:g==="small"?e.jsx(qs,{}):g==="medium"?e.jsx(Qs,{}):e.jsx(Us,{})});let A="";try{A=localStorage.getItem("ppDataExplorerDensity")}catch(y){u.debug(y)}const[g,S]=o.useState(A==="large"||A==="medium"?A:"small");return o.useEffect(()=>{try{localStorage.setItem("ppDataExplorerDensity",g)}catch(y){u.debug(y)}},[g]),p!==""?e.jsx(o.Suspense,{children:e.jsx(ut,{severity:"error",message:p,close:!1})}):e.jsxs(d,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(Ge,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(qe,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((F=Cs.appOrig)==null?void 0:F.appTarget)==="backend"?e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[E(),e.jsx(d,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(ie,{search:n,setSearch:a,addFilter:!0})]}):e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(d,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Data Explorer"}),e.jsx(d,{children:M()}),e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[E(),e.jsx(ie,{search:n,setSearch:a,addFilter:!0})]})]})})}),e.jsx(na,{}),C&&e.jsx(aa,{setCanImport:B}),l==null?e.jsx(d,{sx:{padding:"30px"},children:e.jsx(Es,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[j!==""&&e.jsx(Ne,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(o.Suspense,{children:e.jsx(ut,{severity:"error",message:j,close:!0,setClose:()=>{t(Ss({error:""}))}})})}),e.jsx(Ne,{className:"pp-data-exporer",elevation:4,children:e.jsx(ln,{className:"pp-data-exporer-database-tree pp-density-"+g,"aria-label":"Data Explorer",sx:{display:"grid",gridGap:"0","& li.MuiTreeItem-root:first-of-type li.MuiTreeItem-root:first-of-type":{borderTopLeftRadius:0,borderTopRightRadius:0}},children:Object.keys(l).map(y=>{var w;if(T.includes(b[y])===!1||n!==""&&!se(y,n))return null;const L=((w=b[y])==null?void 0:w.toLocaleLowerCase())==="wp"?y+" (WordPress database)":y;return e.jsx(G,{ref:s,slots:{expandIcon:ot,collapseIcon:z?ot:Hs},itemId:y,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:_=>{var r,x,h,P;if((r=_.target.closest("li"))!=null&&r.classList.contains("pp-data-exporer-database-tree-item"))if((x=_.target.closest("li"))!=null&&x.classList.contains("hide-details")?((h=_.target.closest("li"))==null||h.classList.remove("hide-details"),I(!1)):((P=_.target.closest("li"))==null||P.classList.add("hide-details"),I(!0)),m[y])_.stopPropagation();else{const k=m;k[y]=!0,R(k)}},sx:{padding:"0","&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(d,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(As,{}),L]}),children:e.jsx(Xn,{dbs:y})},y)})})})]})]})};export{fr as default};
