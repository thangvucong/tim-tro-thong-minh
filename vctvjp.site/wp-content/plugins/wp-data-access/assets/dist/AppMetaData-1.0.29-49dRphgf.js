const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SettingsChart-1.0.29-kt52Q7x3.js","./cm-1.0.29-B-jRz_ox.js","./redux-1.0.29-C1Q38y1F.js","./vendor-1.0.29-BmpNFhoq.js","./index-1.0.29-Dlm2kjka.js","./Typography-1.0.29-DKDDWYKJ.js","./lib-1.0.29-C3pCU2AT.js","./loglevel-1.0.29-BZ7XahX3.js","./lodash-1.0.29-CLFJOMhY.js","./moment-1.0.29-C5S46NFB.js","./iconBase-1.0.29-DWX4ew0u.js","./notistack-1.0.29-DTteiN_s.js","./DefaultChartColors-1.0.29-D0-9PmQk.js","./RestApi-1.0.29-D1Nj1ewF.js","./index-1.0.29-DPiWw_1S.js","./FormHelperText-1.0.29-DrHduTUH.js","./useFormControl-1.0.29-DBjraibe.js","./ToggleButtonGroup-1.0.29-DLo1QKzQ.js","./Menu-1.0.29-DOOr2lTO.js","./ThemeProvider-1.0.29-6fkyOh-r.js","./FormLabel-1.0.29-V40o0R6-.js","./RadioGroup-1.0.29-DlKNzHJO.js","./Radio-1.0.29-DtS8PS_A.js","./SwitchBase-1.0.29-aa8fP0Df.js","./useControlled-1.0.29-gPCMf8hr.js","./createSvgIcon-1.0.29-DRHeS-Ok.js","./Slider-1.0.29-Bfsw0S30.js","./visuallyHidden-1.0.29-Dan1xhjv.js","./Spinner-1.0.29-BS14fgdJ.js","./Divider-1.0.29-DUrOUuwN.js","./MenuItem-1.0.29-hQUyAg_Q.js","./TextField-1.0.29-DGwcptkL.js","./InputAdornment-1.0.29-CO4NNpRp.js","./Accordion-1.0.29-DSoQZht0.js","./Collapse-1.0.29-BdBN3O_f.js","./AccordionSummary-1.0.29-Chfx7bsr.js","./AccordionDetails-1.0.29-BFK0928d.js","./PremiumFeature-1.0.29-D7ok1IXl.js","./index-1.0.29-BOWxC8Fi.js","./AdminTheme-1.0.29-j2gnN0Eb.js","./FormControlLabel-1.0.29-BWMy6Yxq.js","./Switch-1.0.29-CFPuiCpy.js","./ChartTypes-1.0.29-CHJhCh--.js","./Autocomplete-1.0.29-BeVKfuIu.js","./Close-1.0.29-DMVND8Dd.js","./Popper-1.0.29-DA77uIz-.js","./ThemeSettings-1.0.29-EwVOQg25.js","./useTheme-1.0.29-BG2eLrmM.js","./index-1.0.29-D3hJYFO0.js","./index-1.0.29--cvqXtNy.js","./Stack-1.0.29-Be5OvNOr.js","./DialogContent-1.0.29-DSOFFK1-.js","./Link-1.0.29-CGZTGwg7.js","./CssUnitTextField-1.0.29-CXDdTLwe.js","./CardContent-1.0.29-D9omFsvB.js","./ResizableDrawer-1.0.29-s3ezSMWr.js","./useScreenSize-1.0.29-C2BqwJQv.js","./ThemeContainer-1.0.29-CLFqgikx.js","./main-1.0.29.js","./FallbackSpinner-1.0.29-Bxoz_pLD.js","./Tooltip-1.0.29-D8cmS8RQ.js"])))=>i.map(i=>d[i]);
import{_ as $}from"./main-1.0.29.js";import{j as e}from"./cm-1.0.29-B-jRz_ox.js";import{b as Ae}from"./ActionsApp-1.0.29-Dk9xbJUd.js";import{r as a}from"./redux-1.0.29-C1Q38y1F.js";import{u as q,a as D,R as Ce}from"./RestApi-1.0.29-D1Nj1ewF.js";import{l,A as J,a9 as Te,N as ve,O as ye,aa as _e,S as V,v as Ee,C as le,ab as ce,M as ke,d as ue,T as Me,ac as Pe,ad as ee,ae as Oe,P as Ne,a as te,af as we,Y as Re,s as Le,ag as Be,b as P,ah as ze,p as Fe,ai as De,aj as Ve,ak as We,al as $e,am as He}from"./lib-1.0.29-C3pCU2AT.js";import{e as w}from"./notistack-1.0.29-DTteiN_s.js";import{u as se,S as re,D as Ue}from"./StoreTypeEnum-1.0.29-CEDpnIsO.js";import{u as Ge,C as Je}from"./Chart-1.0.29-C3cfFZaj.js";import{T as U,C as Ye}from"./ConfirmDialog-1.0.29-CS4WrjWL.js";import{u as Ke,g as qe,c as Xe,B as Qe,a as Ze,T as Ie,b as ae}from"./TabPanel-1.0.29-CHhWjnrS.js";import{e as et,G as tt,A as me,T as he,M as de}from"./index-1.0.29-Dlm2kjka.js";import{A as oe,a as st}from"./AdminTheme-1.0.29-j2gnN0Eb.js";import{u as rt,c as X,B as at,D as Q,R as ot,C as nt,b as it,a as fe,e as pt,f as lt,g as xe,A as ge}from"./useTheme-1.0.29-BG2eLrmM.js";import{a as ct}from"./ActionsSettings-1.0.29-CQwexJxa.js";import{B as O,S as W}from"./Spinner-1.0.29-BS14fgdJ.js";import{T as ut}from"./Typography-1.0.29-DKDDWYKJ.js";import{I as R}from"./iconBase-1.0.29-DWX4ew0u.js";import{C as ne,a as ie,B as G}from"./CardContent-1.0.29-D9omFsvB.js";import{a as mt,T as pe}from"./Tabs-1.0.29-B0UPz-Vu.js";import{F as Y}from"./FallbackSpinner-1.0.29-Bxoz_pLD.js";import{T as K}from"./ThemeProvider-1.0.29-6fkyOh-r.js";import ht from"./Alert-1.0.29-D7hJvMIL.js";import{T as be}from"./Tooltip-1.0.29-D8cmS8RQ.js";import{M as dt}from"./MenuItem-1.0.29-hQUyAg_Q.js";import{M as ft}from"./Menu-1.0.29-DOOr2lTO.js";const xt=a.forwardRef(function(r,i){const{children:m,...p}=r,s=Ke();if(s===null)throw new TypeError("No TabContext provided");const h=a.Children.map(m,n=>a.isValidElement(n)?a.cloneElement(n,{"aria-controls":qe(s,n.props.value),id:Xe(s,n.props.value)}):null);return e.jsx(mt,{...p,ref:i,value:s.value,children:h})}),gt=()=>{const t=q(r=>r.appData);return l.debug("appData",t),t},bt=({appRootId:t,appId:r,appDbId:i,isVisible:m,fullScreen:p})=>{const[s,h]=a.useState(!1);return a.useEffect(()=>{m&&!s&&h(!0)},[m]),s?e.jsx(O,{className:"pp-apps-root"+(m?"":" pp-element-hide"),sx:{"& .pp-app-container .pp-component header.pp-header":{margin:0,visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:e.jsx(Se,{appId:r,appDbId:i,fullScreen:p,appRootId:t})}):null},St=t=>{const r=q(i=>i.appApps[t]!==void 0?i.appApps[t].activeAppId??i.appApps[t].apps[0]:0);return l.debug("activeAppId",r,t),r},jt=t=>{const r=q(i=>i.appData[t]);return l.debug("appData",r),r},At=({appId:t})=>{const r=D(),i=rt(t),m=X(t),p=jt(t);return e.jsx(be,{title:e.jsx(at,{details:i,mode:p==null?void 0:p.mode}),className:"pp-builder-button",children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{var s,h;((h=(s=m==null?void 0:m.app)==null?void 0:s.app[0])==null?void 0:h.app_type)==J.CHART?r(Te({appId:t})):(p==null?void 0:p.mode)===Q.FORM?r(ve({appId:t})):r(ye({appId:t}))},children:e.jsx(et,{})})})},Ct=({appDbId:t,appTitle:r,setActiveApp:i,handleClose:m})=>e.jsx(dt,{onClick:()=>{i(t),m()},children:e.jsx("span",{children:r})}),Tt=({apps:t,setActiveApp:r})=>{const[i,m]=a.useState(null),p=!!i,s=n=>{m(n.currentTarget),n.stopPropagation()},h=()=>{m(null)};return e.jsxs(O,{sx:{position:"relative"},children:[e.jsx(R,{sx:{color:"inherit",padding:0},onClick:s,children:e.jsx(tt,{})}),e.jsxs(ft,{anchorEl:i,open:p,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{marginTop:"8px","& ul":{padding:"0 !important"},"& ul li":{padding:"12px 24px 12px 18px !important"}},children:[...t.apps.map(n=>t.titles[n]===void 0?null:e.jsx(Ct,{appDbId:n,appTitle:t.titles[n],setActiveApp:r,handleClose:h}))]})]})},vt=({appId:t})=>{var c;l.debug(t);const r=D(),i=ot(),m=nt(),p=_e.getSelectors().selectApps(V.getState().appApps,t),s=a.useMemo(()=>{const u={};return Array.isArray(p.apps)&&p.apps.length>0&&p.apps.map(o=>{u[o]=Ee()}),u},[]),h=it(t),n=X(t),T=a.useMemo(()=>{var u,o;return((o=(u=n==null?void 0:n.app)==null?void 0:u.app[0])==null?void 0:o.app_title)!==""?n.app.app[0].app_title:"WP Data Access"},[]),d=St(t),v=u=>{r(Pe({appId:t,activeAppId:u}))};fe(s[d]);const y=pt(s[d]),f=lt(s[d]),S=xe(s[d]),j=ge(S,y,f),[b,k]=a.useState(le.appOrig.appFullscreen===!0);l.debug("appFullScreen",b);const A=gt();a.useEffect(()=>{l.debug("setFullScreen",s,b),Object.keys(s).map(u=>{r(ce({appId:s[Number(u)],property:{fullScreen:b??!1}}))})},[A,b]);const _=((c=A[s[d]])==null?void 0:c.mode)??Q.TABLE;l.debug("mode",_);let M={};const g=()=>null;return p===void 0||Object.keys(s).length===0?e.jsx(W,{}):e.jsx(K,{theme:j,children:e.jsxs(O,{className:"pp-apps-container",sx:{...b?M:{},"& .pp-element-hide":{visibility:"hidden",position:"absolute",left:-99999,top:-99999}},children:[e.jsx(me,{className:"pp-apps-header",position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsxs(he,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(O,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px","& span":{whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold"},"& span.pp-header-title":{minWidth:0,textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"}},children:[e.jsx("span",{children:e.jsx(Tt,{apps:p,setActiveApp:v})}),e.jsxs("span",{className:"pp-header-title",children:[T," - ",p.titles[d]]})]}),e.jsxs(O,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[ke(n)&&e.jsx(At,{appId:s[d]}),g(),(n==null?void 0:n.isExploring)&&e.jsx(be,{title:h.close,children:e.jsx(R,{sx:{color:"inherit",padding:0},onClick:()=>{r(ue({isActive:!1,appDbId:0})),m(t),i(t),r(Me({})),Object.keys(s).map(u=>{m(s[u]),i(s[u])})},children:e.jsx(de,{})})})]})]})}),...p.apps.map(u=>e.jsx(bt,{appRootId:t,appId:s[u],appDbId:u,isVisible:u===d,fullScreen:b}))]})})},yt=a.lazy(()=>$(()=>import("./SettingsChart-1.0.29-kt52Q7x3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45]),import.meta.url)),_t=a.lazy(()=>$(()=>import("./ThemeSettings-1.0.29-EwVOQg25.js"),__vite__mapDeps([46,1,2,3,13,6,7,8,9,47,48,5,4,10,11,37,38,39,20,16,49,28,15,41,23,24,50,51,18,19,26,27,40,52,21,22,25,53,31,54,33,34,35,36]),import.meta.url)),Et=a.lazy(()=>$(()=>import("./ResizableDrawer-1.0.29-s3ezSMWr.js"),__vite__mapDeps([55,1,2,3,56,6,7,8,9,13,5,19,10,18,4,11]),import.meta.url)),kt=({appId:t})=>{var c,u;const r=D(),[i,m]=a.useState(ee.getSelectors().selectChart(V.getState().charts,t));a.useState(Oe.getSelectors().selectThemeById(V.getState().themes,t));const p=fe(t),s=Ge(t),[h,n]=a.useState(!1),[T,d]=a.useState(!1),[v,y]=a.useState("1"),f=(o,E)=>{y(E)},S=()=>{r(we({})),n(!1)},j=()=>{h?d(!0):(A(),S())},b=o=>{l.debug(o),r(Re({appId:t,property:o})),n(!0)},k=o=>{r(Le({anchor:o}))},A=()=>{r(Be({appId:t,chartState:i}))},_=()=>{ct(t,o=>{if(l.debug(o),o!=null&&o.code&&(o==null?void 0:o.message)!==void 0)switch(o.code){case"ok":m(ee.getSelectors().selectChart(V.getState().charts,t)),w(o.message,{variant:"success"});break;case"info":w(o.message,{variant:"info"});break;default:l.error(o),w(o.message??P.contactSupport,{variant:"error"})}},o=>{l.error("error",o),w(o??P.contactSupport,{variant:"error"})}),n(!1)},M=()=>{h?(_(),setTimeout(()=>{S()},1e3)):S()},g=((c=oe)==null?void 0:c.palette.mode)===Ne.LIGHT?(u=oe)==null?void 0:u.palette.primary.main:"";return e.jsx(e.Fragment,{children:s&&e.jsxs(e.Fragment,{children:[e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsxs(Et,{closeDrawer:j,children:[e.jsx(me,{position:"static",elevation:4,sx:{borderRadius:0},children:e.jsxs(he,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(ut,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,paddingLeft:"6px"},children:"Chart Builder"}),e.jsx(U,{title:"Dock to left",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Qe,{})})}),e.jsx(U,{title:"Dock to right",position:"bottom",children:e.jsx(R,{onClick:()=>{k(te.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Ze,{})})}),e.jsx(U,{title:"Close",position:"bottom",children:e.jsx(R,{onClick:j,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(de,{})})})]})}),e.jsx(ne,{className:"pp-settings-container",children:e.jsx(ie,{sx:{padding:0,margin:0},children:e.jsxs(Ie,{value:v,children:[e.jsxs(xt,{variant:"fullWidth",textColor:"primary",onChange:f,sx:{width:"100%",height:"80px",padding:0,margin:0,backgroundColor:"rgb(242, 242, 242)"},children:[e.jsx(pe,{label:"Chart",value:"1",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(pe,{label:"Theme",value:"2",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}})]}),e.jsxs(O,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 250px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(ae,{value:"1",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(yt,{appId:t,chartSettings:p,updateSettings:b})})}),e.jsx(ae,{value:"2",children:e.jsx(a.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(_t,{appId:t,source:Q.TABLE,setIsUpdated:n})})})]})]})})}),e.jsx(ne,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:g},children:e.jsxs(ie,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(G,{variant:"outlined",className:"footer_action_button_apply",onClick:_,children:"Apply"}),e.jsx(G,{variant:"outlined",className:"footer_action_button",onClick:M,children:"OK"}),e.jsx(G,{variant:"outlined",className:"footer_action_button",onClick:j,children:"Cancel"})]})})]})}),e.jsx(Ye,{title:"Close Chart Builder?",message:"All uncommitted changes will be lost!",open:T,setOpen:d,onConfirm:()=>{A(),S()},onKeep:()=>{S()}})]})})},Mt=({appId:t,appDbId:r})=>{l.debug(t,r);const i=D(),[m,p]=a.useState(!1),s=X(t),h=xe(),n=ge(h,Fe.table,ze.form),T=a.useMemo(()=>st(),[]),d=f=>{switch(f.substring(0,f.indexOf("(")).toLowerCase()){case"decimal":case"double":case"double precision":case"float":case"real":case"bit":case"tinyint":case"smallint":case"int":case"integer":case"mediumint":case"bigint":return"number";case"time":return"time";case"date":return"date";case"datetime":case"timestamp":return"datetime"}return"text"},v=()=>{Ce(le.appUrlChartData,{app_id:r},f=>{var S,j,b,k,A,_,M,g,c,u,o,E;if(l.debug(f),(f==null?void 0:f.data)!==void 0){if(Array.isArray(f.data)){const L=f.data,B=[];f.explain.map(x=>{x.Type?B.push(d(x.Type)):x.type?B.push(d(x.type)):x.TYPE&&B.push(d(x.TYPE))}),l.debug(B);const N=[],Z=[];Object.keys(L[0]).map(x=>Z.push(x)),N.push(Z);for(let x=0;x<L.length;x++){const H=[];Object.keys(L[x]).map((I,je)=>B[je]==="text"?H.push(L[x][I]):H.push(Number(L[x][I]))),N.push(H)}l.debug(N);let C={};if(((j=(S=s==null?void 0:s.app)==null?void 0:S.app[0])==null?void 0:j.app_theme)!==void 0&&((k=(b=s==null?void 0:s.app)==null?void 0:b.app[0])==null?void 0:k.app_theme)!==null&&((_=(A=s==null?void 0:s.app)==null?void 0:A.app[0])==null?void 0:_.app_theme)!=="")try{C=JSON.parse(s.app.container[0].cnt_chart)}catch(x){l.error("Invalid JSON - theme settings"),l.error(x)}C===!1&&(C={}),l.debug(C);const z=De({},Ve,C);z.data=N,z.majorAxisColumn=N[0][0],z.minorAxisColumns=N[0].slice(1),Array.isArray(C==null?void 0:C.chartTypes)&&C.chartTypes.length>0&&(z.chartType=C.chartTypes[0]),i(We({appId:t,chartState:z}));let F={};if(((g=(M=s==null?void 0:s.app)==null?void 0:M.app[0])==null?void 0:g.app_theme)!==void 0&&((u=(c=s==null?void 0:s.app)==null?void 0:c.app[0])==null?void 0:u.app_theme)!==null&&((E=(o=s==null?void 0:s.app)==null?void 0:o.app[0])==null?void 0:E.app_theme)!=="")try{F=JSON.parse(s.app.app[0].app_theme)}catch(x){l.error("Invalid JSON - theme settings"),l.error(x)}F===!1&&(F={}),l.debug(F),i($e({appId:t,themeState:F})),p(!0)}}else l.error("Error loading chart data")},()=>{l.error("Error loading chart data")})};a.useEffect(()=>{v()},[]);const y=a.useMemo(()=>!0,[]);return m?e.jsxs(e.Fragment,{children:[e.jsx(K,{theme:n,children:e.jsx(Je,{appId:t,isBuilderEnabled:y,isToolbarEnabled:!0,isExploring:s==null?void 0:s.isExploring})}),y&&e.jsx(K,{theme:T,children:e.jsx(kt,{appId:t})})]}):e.jsx(Y,{})},Pt=a.lazy(()=>$(()=>import("./ThemeContainer-1.0.29-CLFqgikx.js").then(t=>t.T),__vite__mapDeps([57,1,2,3,58,11,6,7,8,9,13,47,48,5,4,10,59,28,60,19,45,24]),import.meta.url)),Se=({appId:t,appDbId:r,designMode:i,staticFilter:m,shortcodeArgs:p,fullScreen:s,isExploring:h,appRootId:n})=>{l.debug(t,r,i,m,p,s,h);const T=D(),[d,v]=a.useState(""),[y,f]=a.useState(!1),[S,j]=a.useState(!1),[b,k]=a.useState(!1),{prepareAppStore:A}=se(t,re.APP),{prepareApp:_}=se(t,re.APP);a.useEffect(()=>{y||M()},[r]);const M=()=>{Ae(r,g=>{var u,o;const c=g==null?void 0:g.data;if(l.debug("response data",c),c.app&&c.app.app&&Array.isArray(c.app.app)&&c.app.container&&Array.isArray(c.app.container)&&c.app.apps&&Array.isArray(c.app.apps))if(c.app.app[0].app_type==J.APPCONTAINER)_(c,h),j(!0),f(!0);else if(c.app.app[0].app_type==J.CHART){const E={...c};E.src=Ue(r,(o=(u=c==null?void 0:c.app)==null?void 0:u.container[0])==null?void 0:o.cnt_id),h===!0&&(E.isExploring=!0),n!==void 0&&(E.appRootId=n),T(He({appId:t,metaData:E})),k(!0),f(!0)}else A(r,c,i===!0,void 0,n,()=>{})?(T(ce({appId:t,property:{staticFilter:m,shortcodeArgs:p}})),f(!0)):v(P.contactSupport);else w(P.contactSupport,{variant:"error"}),v(P.contactSupport)},g=>{l.error("error",g),w(g??P.contactSupport,{variant:"error"}),v(g??P.contactSupport)})};return d!==""?e.jsx(a.Suspense,{children:e.jsx(ht,{severity:"error",message:d,close:!0,setClose:()=>{T(ue({isActive:!1,appDbId:0}))}})}):y?S?e.jsx(vt,{appId:t}):b?e.jsx(Mt,{appId:t,appDbId:r}):e.jsx(O,{id:"pp-app-"+t,className:"pp-app-container pp-app-"+r,sx:{[`&#pp-app-${t} .pp-column-search-field ul`]:{marginLeft:0,padding:0},[`&#pp-app-${t} .pp-global-search-field input, &#pp-app-${t} .pp-column-search-field input`]:{boxSizing:"content-box"},[`&#pp-app-${t} .pp-form form input`]:{boxSizing:"content-box"}},children:e.jsx(a.Suspense,{fallback:e.jsx(Y,{}),children:e.jsx(Pt,{appId:t})})}):e.jsx(Y,{})},rs=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{Se as A,xt as T,rs as a};
